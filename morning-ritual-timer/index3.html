<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wake Up and Rise - 30-Day Reset Challenge</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 16px;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .timer-container {
            max-width: 380px;
            width: 100%;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 40px -12px rgba(0, 0, 0, 0.25);
            transition: background-color 2000ms ease-in-out;
        }

        /* Dynamic phase colors */
        .phase-light { background-color: #fef3c7; }
        .phase-cool { background-color: #dbeafe; }
        .phase-movement { background-color: #dcfce7; }
        .phase-fuel { background-color: #fce7f3; }
        .phase-gratitude { background-color: #ede9fe; }
        .phase-intentions { background-color: #dbeafe; }
        .phase-visualization { background-color: #ccfbf1; }

        .header {
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            color: #374151;
            padding: 20px;
            text-align: center;
        }

        .phase-info {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .phase-icon {
            font-size: 28px;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .phase-icon svg {
            width: 24px;
            height: 24px;
        }

        .phase-title {
            font-size: 22px;
            font-weight: 300;
            margin: 0;
        }

        .phase-step {
            font-size: 13px;
            opacity: 70%;
            margin: 0;
        }

        .audio-controls {
            display: flex;
            gap: 6px;
            justify-content: center;
            margin-top: 12px;
        }

        .audio-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            color: #6b7280;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .audio-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        .audio-btn.enabled {
            background: rgba(255, 255, 255, 0.2);
            color: #374151;
        }

        .progress-bar {
            background: #e5e7eb;
            height: 4px;
        }

        .progress-fill {
            background: #374151;
            height: 100%;
            transition: width 1000ms ease-out;
        }

        .content {
            padding: 24px 20px;
            text-align: center;
        }

        .gif-container {
            height: 140px;
            width: 100%;
            max-width: 240px;
            margin: 0 auto 20px;
            border-radius: 12px;
            overflow: hidden;
            background: transparent;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .gif-container img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 12px;
            transition: transform 0.3s ease;
        }

        .gif-container img:hover {
            transform: scale(1.02);
        }

        .gif-container .fallback-emoji {
            font-size: 64px;
            opacity: 0.7;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.7; }
            50% { transform: scale(1.05); opacity: 0.9; }
        }

        .timer-display {
            font-size: 48px;
            font-weight: 100;
            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', monospace;
            color: #374151;
            margin-bottom: 24px;
            letter-spacing: 2px;
        }

        .guidance-box {
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 24px;
        }

        .guidance-title {
            font-size: 16px;
            font-weight: 500;
            color: #374151;
            margin-bottom: 8px;
        }

        .guidance-text {
            color: #6b7280;
            line-height: 1.5;
            font-size: 13px;
        }

        .controls {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-bottom: 24px;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.4);
            border: none;
            border-radius: 40px;
            padding: 12px 24px;
            color: #374151;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.6);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .control-btn:active {
            transform: translateY(0);
        }

        .phase-nav {
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            padding-top: 16px;
        }

        .phase-nav-title {
            font-size: 12px;
            font-weight: 500;
            color: #6b7280;
            margin-bottom: 12px;
        }

        .phase-dots {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 6px;
        }

        .phase-dot {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 12px;
            padding: 8px 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
            font-size: 10px;
            color: #6b7280;
        }

        .phase-dot:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .phase-dot.active {
            background: rgba(255, 255, 255, 0.5);
            color: #374151;
            transform: scale(1.02);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .phase-dot.completed {
            background: rgba(255, 255, 255, 0.3);
            color: #6b7280;
        }

        .phase-dot-icon {
            font-size: 14px;
            margin-bottom: 1px;
            width: 14px;
            height: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .phase-dot-icon svg {
            width: 12px;
            height: 12px;
        }

        .phase-dot.completed .phase-dot-icon {
            color: #22c55e;
        }

        .phase-dot-number {
            font-size: 9px;
            font-weight: 600;
        }

        .completion {
            text-align: center;
            padding: 40px 24px;
        }

        .completion-title {
            font-size: 32px;
            font-weight: 300;
            color: #374151;
            margin-bottom: 16px;
        }

        .completion-message {
            font-size: 18px;
            color: #6b7280;
            margin-bottom: 32px;
            line-height: 1.6;
        }

        .music-player {
            margin-top: 24px;
            opacity: 0.7;
        }

        .music-player audio {
            width: 100%;
            height: 40px;
        }

        @media (max-width: 480px) {
            .timer-container {
                margin: 10px;
            }
            
            .timer-display {
                font-size: 48px;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .phase-dots {
                grid-template-columns: repeat(4, 1fr);
                gap: 6px;
            }
        }
    </style>
</head>
<body>
    <div class="timer-container phase-light" id="timerContainer">
        <!-- Header -->
        <div class="header">
            <div class="phase-info">
                <div class="phase-icon" id="phaseIcon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/></svg>
                </div>
                <div>
                    <h1 class="phase-title" id="phaseTitle">Light & Hydration</h1>
                    <p class="phase-step" id="phaseStep">Step 1 of 7</p>
                </div>
            </div>
            
            <div class="audio-controls">
                <button class="audio-btn enabled" id="voiceBtn" onclick="toggleVoice()" title="Voice guidance">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"/></svg>
                </button>
                <button class="audio-btn enabled" id="musicBtn" onclick="toggleMusic()" title="Background music">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg>
                </button>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 14.3%"></div>
        </div>

        <!-- Main App -->
        <div class="content" id="app">
            <!-- GIF Container -->
            <div class="gif-container" id="gifContainer">
                <div class="fallback-emoji">☀️</div>
            </div>

            <!-- Timer -->
            <div class="timer-display" id="timerDisplay">10:00</div>

            <!-- Guidance -->
            <div class="guidance-box">
                <div class="guidance-title" id="guidanceTitle">Let the morning light find you.</div>
                <div class="guidance-text" id="guidanceText">
                    Step outside or open those curtains. Let the light touch your face. Sip some water slowly - maybe with a pinch of salt or lemon. This is your sacred time for light, water, and gentle presence.
                </div>
            </div>

            <!-- Controls -->
            <div class="controls">
                <button class="control-btn" onclick="startTimer()" id="startBtn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5,3 19,12 5,21"/></svg>
                    Begin Gently
                </button>
                <button class="control-btn" onclick="pauseTimer()" id="pauseBtn" style="display:none">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>
                    Pause
                </button>
            </div>

            <!-- Reset button -->
            <div style="text-align: center; margin-bottom: 24px;">
                <button onclick="resetTimer()" style="background: rgba(255,255,255,0.2); border: none; border-radius: 20px; padding: 8px 16px; color: #6b7280; font-size: 12px; cursor: pointer;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="1,4 1,10 7,10"/><path d="M3.51,15a9,9 0,0,0,13.48,0,9,9 0,0,0,0-12"/></svg>
                    Reset
                </button>
            </div>

            <!-- Phase Navigation -->
            <div class="phase-nav">
                <div class="phase-nav-title">Your morning ritual:</div>
                <div class="phase-dots" id="phaseDots">
                    <!-- Phase dots will be generated by JavaScript -->
                </div>
            </div>

            <!-- Music Player -->
            <div class="music-player">
                <audio id="musicPlayer" controls></audio>
            </div>
        </div>

        <!-- Completion Screen -->
        <div class="completion" id="completion" style="display:none;">
            <h2 class="completion-title">Well done!</h2>
            <div class="completion-message">
                You've completed your morning ritual. You chose to begin. That's everything.
            </div>
            <div style="display: flex; justify-content: center;">
                <button class="control-btn" onclick="resetForTomorrow()">
                    Tomorrow Awaits
                </button>
            </div>
        </div>

        <!-- Hidden Voice Audio -->
        <audio id="voicePlayer"></audio>
    </div>

    <script>
        // Configuration
        const ELEVEN_API_KEY = 'sk_0f784c61526bd19de89206bf1d1a4e30f698e5bd8b0dd39b';
        const ELEVEN_VOICE_ID = 'WdMh5yw0KuyjyTlKfH2b';

        const audioFiles = [
            'https://klossgott.github.io/infocusapp/timer/audios/pianomusic1.mp3',
            'https://klossgott.github.io/infocusapp/timer/audios/pianomusic2.mp3',
            'https://klossgott.github.io/infocusapp/timer/audios/pianomusic3.mp3',
            'https://klossgott.github.io/infocusapp/timer/audios/pianomusic4.mp3',
            'https://klossgott.github.io/infocusapp/timer/audios/pianomusic5.mp3',
            'https://klossgott.github.io/infocusapp/timer/audios/pianomusic6.mp3',
            'https://klossgott.github.io/infocusapp/timer/audios/pianomusic7.mp3'
        ];

        const phases = [
            {
                name: 'Light & Hydration',
                duration: 600,
                iconSvg: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/></svg>',
                iconSvgSmall: '<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/></svg>',
                color: 'phase-light',
                instructions: 'Let the morning light find you.',
                guidance: 'Step outside or open those curtains. Let the light touch your face. Sip some water slowly - maybe with a pinch of salt or lemon. This is your sacred time for light, water, and gentle presence.',
                gifFolder: 'sunshine'
            },
            {
                name: 'Cool Refresh',
                duration: 30,
                iconSvg: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z"/></svg>',
                iconSvgSmall: '<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z"/></svg>',
                color: 'phase-cool',
                instructions: 'Here comes your moment of gentle courage.',
                guidance: 'At the end of your warm shower, turn the water cool for just 30 seconds. Breathe slowly and deeply. You\'ve got this.',
                gifFolder: 'coldshower'
            },
            {
                name: 'Movement to Music',
                duration: 75,
                iconSvg: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg>',
                iconSvgSmall: '<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg>',
                color: 'phase-movement',
                instructions: 'What song makes your spirit dance?',
                guidance: 'Put on music that lifts your soul. Dance, stretch, sway - however feels good. You\'re waking up joy.',
                gifFolder: 'dance'
            },
            {
                name: 'Nourishing Fuel',
                duration: 300,
                iconSvg: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 8h1a4 4 0 0 1 0 8h-1"/><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"/></svg>',
                iconSvgSmall: '<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 8h1a4 4 0 0 1 0 8h-1"/><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"/></svg>',
                color: 'phase-fuel',
                instructions: 'What will nourish your body today?',
                guidance: 'Prepare protein mindfully - eggs, yogurt, or a protein shake. This is self-care in action.',
                gifFolder: 'breakfast'
            },
            {
                name: 'Gratitude',
                duration: 60,
                iconSvg: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>',
                iconSvgSmall: '<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>',
                color: 'phase-gratitude',
                instructions: 'What fills your heart with warmth?',
                guidance: 'Place your hand on your heart. Think of three things you appreciate. Feel that warmth.',
                gifFolder: 'thank you'
            },
            {
                name: 'Intentions',
                duration: 60,
                iconSvg: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>',
                iconSvgSmall: '<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>',
                color: 'phase-intentions',
                instructions: 'What would make today meaningful?',
                guidance: 'Consider 1-3 things that matter most today. What would make you feel proud this evening?',
                gifFolder: 'intention'
            },
            {
                name: 'Visualization',
                duration: 60,
                iconSvg: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>',
                iconSvgSmall: '<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>',
                color: 'phase-visualization',
                instructions: 'Can you see yourself moving through today with grace?',
                guidance: 'Close your eyes. See yourself accomplishing your intentions with ease and confidence.',
                gifFolder: 'vision'
            }
        ];

        // State
        let currentPhase = 0;
        let timeLeft = phases[0].duration;
        let isRunning = false;
        let timer = null;
        let fadeInterval = null;
        let voiceEnabled = true;
        let musicEnabled = true;

        const musicPlayer = document.getElementById('musicPlayer');
        const voicePlayer = document.getElementById('voicePlayer');

        // Audio functions
        function fadeVolume(audio, target, duration = 500) {
            if (!audio) return;
            clearInterval(fadeInterval);
            const stepTime = 50;
            const steps = duration / stepTime;
            const start = audio.volume;
            const diff = target - start;
            let i = 0;
            fadeInterval = setInterval(() => {
                i++;
                audio.volume = Math.max(0, Math.min(1, start + (diff * i) / steps));
                if (i >= steps) {
                    clearInterval(fadeInterval);
                    audio.volume = target;
                }
            }, stepTime);
        }

        // Load local GIF from folder
        async function loadLocalGif(folderName) {
            try {
                const extensions = ['gif', 'webp'];
                const commonNames = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', 
                                   'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j'];
                
                for (const ext of extensions) {
                    for (const name of commonNames) {
                        const url = `https://klossgott.github.io/morning-ritual-timer/gifs/${folderName}/${name}.${ext}`;
                        
                        try {
                            const img = new Image();
                            img.src = url;
                            
                            await new Promise((resolve, reject) => {
                                img.onload = resolve;
                                img.onerror = reject;
