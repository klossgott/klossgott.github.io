<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Morning Ritual Timer</title>
    <!-- Feather Icons -->
    <script src="https://unpkg.com/feather-icons"></script>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 16px;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .timer-container {
            max-width: 380px;
            width: 100%;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 40px -12px rgba(0, 0, 0, 0.25);
            transition: background-color 1000ms ease-in-out;
        }

        /* Dynamic phase colors - RESTORED */
        .phase-light { background-color: #fef3c7; }
        .phase-cool { background-color: #dbeafe; }
        .phase-movement { background-color: #dcfce7; }
        .phase-fuel { background-color: #fce7f3; }
        .phase-gratitude { background-color: #ede9fe; }
        .phase-intentions { background-color: #dbeafe; }
        .phase-visualization { background-color: #ccfbf1; }

        /* Header with glassmorphism - MORE COMPACT */
        .header {
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            color: #374151;
            padding: 20px;
            text-align: center;
        }

        .phase-info {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .phase-icon {
            font-size: 28px;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .phase-icon svg {
            width: 24px;
            height: 24px;
        }

        .phase-title {
            font-size: 22px;
            font-weight: 300;
            margin: 0;
        }

        .phase-step {
            font-size: 13px;
            opacity: 70%;
            margin: 0;
        }

        .audio-controls {
            display: flex;
            gap: 6px;
            justify-content: center;
            margin-top: 12px;
        }

        /* NEUTRAL ICON BUTTONS */
        .audio-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            color: #6b7280;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .audio-btn svg {
            width: 16px;
            height: 16px;
        }

        .audio-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        .audio-btn.enabled {
            background: rgba(255, 255, 255, 0.2);
            color: #374151;
        }

        /* Progress bar */
        .progress-bar {
            background: #e5e7eb;
            height: 4px;
        }

        .progress-fill {
            background: #374151;
            height: 100%;
            transition: width 1000ms ease-out;
        }

        /* Main content - MORE COMPACT */
        .content {
            padding: 24px 20px;
            text-align: center;
        }

        /* GIF Container - TRANSPARENT with smaller size */
        .gif-container {
            height: 140px;
            width: 100%;
            max-width: 240px;
            margin: 0 auto 20px;
            border-radius: 12px;
            overflow: hidden;
            background: transparent;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .gif-container img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 12px;
            transition: transform 0.3s ease;
        }

        .gif-container img:hover {
            transform: scale(1.02);
        }

        .gif-container .fallback-emoji {
            font-size: 64px;
            opacity: 0.7;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.7; }
            50% { transform: scale(1.05); opacity: 0.9; }
        }

        /* Timer display - MORE COMPACT */
        .timer-display {
            font-size: 48px;
            font-weight: 100;
            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', monospace;
            color: #374151;
            margin-bottom: 24px;
            letter-spacing: 2px;
        }

        /* Guidance box - MORE COMPACT */
        .guidance-box {
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 24px;
        }

        .guidance-title {
            font-size: 16px;
            font-weight: 500;
            color: #374151;
            margin-bottom: 8px;
        }

        .guidance-text {
            color: #6b7280;
            line-height: 1.5;
            font-size: 13px;
        }

        /* Controls - MORE COMPACT */
        .controls {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-bottom: 24px;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.4);
            border: none;
            border-radius: 40px;
            padding: 12px 24px;
            color: #374151;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.6);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .control-btn:active {
            transform: translateY(0);
        }

        /* Phase navigation - MORE COMPACT */
        .phase-nav {
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            padding-top: 16px;
        }

        .phase-nav-title {
            font-size: 12px;
            font-weight: 500;
            color: #6b7280;
            margin-bottom: 12px;
        }

        .phase-dots {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 6px;
        }

        .phase-dot {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 12px;
            padding: 8px 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
            font-size: 10px;
            color: #6b7280;
        }

        .phase-dot:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .phase-dot.active {
            background: rgba(255, 255, 255, 0.5);
            color: #374151;
            transform: scale(1.02);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .phase-dot.completed {
            background: rgba(255, 255, 255, 0.3);
            color: #6b7280;
        }

        .phase-dot-icon {
            font-size: 14px;
            margin-bottom: 1px;
            width: 14px;
            height: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .phase-dot-icon svg {
            width: 12px;
            height: 12px;
        }

        /* Completed phase styling */
        .phase-dot.completed .phase-dot-icon {
            color: #22c55e; /* Green tick */
        }

        .phase-dot-number {
            font-size: 9px;
            font-weight: 600;
        }

        /* Completion screen */
        .completion {
            text-align: center;
            padding: 40px 24px;
        }

        .completion-emoji {
            font-size: 80px;
            margin-bottom: 24px;
        }

        .completion-title {
            font-size: 32px;
            font-weight: 300;
            color: #374151;
            margin-bottom: 16px;
        }

        .completion-message {
            font-size: 18px;
            color: #6b7280;
            margin-bottom: 32px;
            line-height: 1.6;
        }

        /* Music player */
        .music-player {
            margin-top: 24px;
            opacity: 0.7;
        }

        .music-player audio {
            width: 100%;
            height: 40px;
        }

        /* Responsive */
        @media (max-width: 480px) {
            .timer-container {
                margin: 10px;
            }
            
            .timer-display {
                font-size: 48px;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .phase-dots {
                grid-template-columns: repeat(4, 1fr);
                gap: 6px;
            }
        }
    </style>
</head>
<body>
    <div class="timer-container phase-light" id="timerContainer">
        <!-- Header -->
        <div class="header">
            <div class="phase-info">
                <div class="phase-icon" id="phaseIcon">‚òÄÔ∏è</div>
                <div>
                    <h1 class="phase-title" id="phaseTitle">Light & Hydration</h1>
                    <p class="phase-step" id="phaseStep">Step 1 of 7</p>
                </div>
            </div>
            
            <div class="audio-controls">
                <button class="audio-btn enabled" id="voiceBtn" onclick="toggleVoice()" title="Voice guidance">
                    üé§
                </button>
                <button class="audio-btn enabled" id="musicBtn" onclick="toggleMusic()" title="Background music">
                    üéµ
                </button>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 14.3%"></div>
        </div>

        <!-- Main App -->
        <div class="content" id="app">
            <!-- Transparent GIF Container (smaller size) -->
            <div class="gif-container" id="gifContainer">
                <div class="fallback-emoji">‚òÄÔ∏è</div>
            </div>

            <!-- Timer -->
            <div class="timer-display" id="timerDisplay">0:10</div>

            <!-- Guidance -->
            <div class="guidance-box">
                <div class="guidance-title" id="guidanceTitle">Let the morning light find you.</div>
                <div class="guidance-text" id="guidanceText">
                    Step outside or open those curtains. Let the light touch your face. Sip some water slowly - maybe with a pinch of salt or lemon. This is your sacred time for light, water, and gentle presence.
                </div>
            </div>

            <!-- Controls -->
            <div class="controls">
                <button class="control-btn" onclick="startTimer()" id="startBtn">
                    ‚ñ∂Ô∏è Begin Gently
                </button>
                <button class="control-btn" onclick="pauseTimer()" id="pauseBtn" style="display:none">
                    ‚è∏Ô∏è Pause
                </button>
                <button class="control-btn" onclick="resetTimer()">
                    üîÑ Reset
                </button>
            </div>

            <!-- Phase Navigation -->
            <div class="phase-nav">
                <div class="phase-nav-title">Your morning ritual:</div>
                <div class="phase-dots" id="phaseDots"></div>
            </div>

            <!-- Music Player -->
            <div class="music-player">
                <audio id="musicPlayer" controls></audio>
            </div>
        </div>

        <!-- Completion Screen -->
        <div class="completion" id="completion" style="display:none;">
            <div class="completion-emoji">üåÖ</div>
            <h2 class="completion-title">Well done!</h2>
            <div class="completion-message">
                You've completed your morning ritual. You chose to begin. That's everything.
            </div>
            <button class="control-btn" onclick="resetForTomorrow()">
                Tomorrow Awaits
            </button>
        </div>

        <!-- Hidden Voice Audio -->
        <audio id="voicePlayer"></audio>
    </div>

    <script>
        // Configuration
        const ELEVEN_API_KEY = 'sk_0f784c61526bd19de89206bf1d1a4e30f698e5bd8b0dd39b';
        const ELEVEN_VOICE_ID = 'WdMh5yw0KuyjyTlKfH2b';
        const GIPHY_API_KEY = 'cOYmv8uODh0R6j65dPvypGTrw0vHO9L5';

        const audioFiles = [
            'https://klossgott.github.io/infocusapp/timer/audios/pianomusic1.mp3',
            'https://klossgott.github.io/infocusapp/timer/audios/pianomusic2.mp3',
            'https://klossgott.github.io/infocusapp/timer/audios/pianomusic3.mp3',
            'https://klossgott.github.io/infocusapp/timer/audios/pianomusic4.mp3',
            'https://klossgott.github.io/infocusapp/timer/audios/pianomusic5.mp3',
            'https://klossgott.github.io/infocusapp/timer/audios/pianomusic6.mp3',
            'https://klossgott.github.io/infocusapp/timer/audios/pianomusic7.mp3'
        ];

        const phases = [
            {
                name: 'Light & Hydration',
                duration: 10,
                icon: 'sun',
                color: 'phase-light',
                instructions: 'Let the morning light find you.',
                guidance: 'Step outside or open those curtains. Let the light touch your face. Sip some water slowly - maybe with a pinch of salt or lemon. This is your sacred time for light, water, and gentle presence.',
                stickerTags: ['sunrise', 'morning light', 'sunshine', 'golden hour', 'dawn', 'daybreak', 'morning glow', 'bright sun', 'morning rays', 'sunbeam', 'early morning', 'morning sky', 'radiant sun', 'sunny morning', 'light therapy', 'vitamin d', 'morning warmth', 'sun exposure', 'natural light', 'awakening']
            },
            {
                name: 'Cool Refresh',
                duration: 5,
                icon: 'droplets',
                color: 'phase-cool',
                instructions: 'Here comes your moment of gentle courage.',
                guidance: 'At the end of your warm shower, turn the water cool for just 30 seconds. Breathe slowly and deeply. You\'ve got this.',
                stickerTags: ['cold shower', 'refreshing', 'water drops', 'splash', 'cool water', 'invigorate', 'wake up', 'fresh', 'energizing', 'revitalizing', 'shower', 'water therapy', 'cold plunge', 'ice bath', 'cooling', 'rejuvenating', 'crisp', 'awakening', 'stimulating', 'bracing']
            },
            {
                name: 'Movement to Music',
                duration: 10,
                icon: 'music',
                color: 'phase-movement',
                instructions: 'What song makes your spirit dance?',
                guidance: 'Put on music that lifts your soul. Dance, stretch, sway - however feels good. You\'re waking up joy.',
                stickerTags: ['dancing', 'movement', 'exercise', 'stretching', 'yoga', 'fitness', 'active', 'energetic', 'motion', 'groove', 'rhythm', 'body movement', 'dance party', 'workout', 'flexibility', 'morning exercise', 'kinetic', 'dynamic', 'flowing', 'expressive']
            },
            {
                name: 'Nourishing Fuel',
                duration: 10,
                icon: 'coffee',
                color: 'phase-fuel',
                instructions: 'What will nourish your body today?',
                guidance: 'Prepare protein mindfully - eggs, yogurt, or a protein shake. This is self-care in action.',
                stickerTags: ['healthy breakfast', 'nutrition', 'protein', 'nourishing', 'wholesome', 'fresh food', 'healthy eating', 'fuel', 'energy food', 'breakfast', 'organic', 'nutrients', 'vitamins', 'superfood', 'clean eating', 'mindful eating', 'balanced meal', 'wellness food', 'nutritious', 'sustenance']
            },
            {
                name: 'Gratitude',
                duration: 10,
                icon: 'heart',
                color: 'phase-gratitude',
                instructions: 'What fills your heart with warmth?',
                guidance: 'Place your hand on your heart. Think of three things you appreciate. Feel that warmth.',
                stickerTags: ['gratitude', 'thankful', 'appreciation', 'blessed', 'grateful heart', 'mindfulness', 'positive thinking', 'counting blessings', 'thankfulness', 'appreciation practice', 'mindful gratitude', 'heart centered', 'emotional wellness', 'positive mindset', 'inner peace', 'contentment', 'joy', 'happiness', 'loving kindness', 'abundance']
            },
            {
                name: 'Intentions',
                duration: 10,
                icon: 'target',
                color: 'phase-intentions',
                instructions: 'What would make today meaningful?',
                guidance: 'Consider 1-3 things that matter most today. what would make you feel proud this evening?',
                stickerTags: ['goal setting', 'intention', 'focus', 'purpose', 'planning', 'vision', 'clarity', 'direction', 'mindful planning', 'daily goals', 'motivation', 'ambition', 'determination', 'commitment', 'aspiration', 'objective', 'mission', 'target', 'aim', 'resolution']
            },
            {
                name: 'Visualization',
                duration: 10,
                icon: 'eye',
                color: 'phase-visualization',
                instructions: 'Can you see yourself moving through today with grace?',
                guidance: 'Close your eyes. See yourself accomplishing your intentions with ease and confidence.',
                stickerTags: ['vision', 'success', 'achievement', 'visualization', 'manifestation', 'dreams', 'accomplishment', 'victory', 'triumph', 'winning', 'mental imagery', 'positive visualization', 'goal achievement', 'success mindset', 'confidence', 'empowerment', 'self-belief', 'mental rehearsal', 'future self', 'potential']
            }
        ];

        // State
        let currentPhase = 0;
        let timeLeft = phases[0].duration;
        let isRunning = false;
        let timer = null;
        let fadeInterval = null;
        let voiceEnabled = true;
        let musicEnabled = true;

        const musicPlayer = document.getElementById('musicPlayer');
        const voicePlayer = document.getElementById('voicePlayer');

        // Audio functions from your working example
        function fadeVolume(audio, target, duration = 500) {
            if (!audio) return;
            clearInterval(fadeInterval);
            const stepTime = 50;
            const steps = duration / stepTime;
            const start = audio.volume;
            const diff = target - start;
            let i = 0;
            fadeInterval = setInterval(() => {
                i++;
                audio.volume = Math.max(0, Math.min(1, start + (diff * i) / steps));
                if (i >= steps) {
                    clearInterval(fadeInterval);
                    audio.volume = target;
                }
            }, stepTime);
        }

        async function fetchSticker(tags) {
            try {
                const randomTag = tags[Math.floor(Math.random() * tags.length)];
                console.log('üéØ Fetching sticker for:', randomTag);
                
                const res = await fetch(
                    `https://api.giphy.com/v1/stickers/search?api_key=${GIPHY_API_KEY}&q=${encodeURIComponent(randomTag)}&limit=20&rating=pg`
                );
                
                if (res.ok) {
                    const json = await res.json();
                    if (json.data?.length) {
                        const idx = Math.floor(Math.random() * json.data.length);
                        const gifContainer = document.getElementById('gifContainer');
                        gifContainer.innerHTML = `<img src="${json.data[idx].images.fixed_height.url}" alt="Phase sticker">`;
                        console.log('‚ú® Sticker loaded successfully');
                        return;
                    }
                }
                
                showFallbackGif();
            } catch (e) {
                console.error('Sticker error', e);
                showFallbackGif();
            }
        }

        // CELEBRATION GIFS for completion
        async function fetchCelebrationGif() {
            try {
                const celebrationTags = ['celebration', 'success', 'victory', 'achievement', 'congratulations', 'well done', 'accomplished', 'winner', 'morning success', 'ritual complete'];
                const randomTag = celebrationTags[Math.floor(Math.random() * celebrationTags.length)];
                console.log('üéâ Fetching celebration GIF for:', randomTag);
                
                const res = await fetch(
                    `https://api.giphy.com/v1/gifs/search?api_key=${GIPHY_API_KEY}&q=${encodeURIComponent(randomTag)}&limit=20&rating=pg`
                );
                
                if (res.ok) {
                    const json = await res.json();
                    if (json.data?.length) {
                        const idx = Math.floor(Math.random() * json.data.length);
                        // Add celebration GIF to completion screen
                        const completionDiv = document.getElementById('completion');
                        const existingGif = completionDiv.querySelector('.celebration-gif');
                        if (existingGif) existingGif.remove();
                        
                        const gifDiv = document.createElement('div');
                        gifDiv.className = 'celebration-gif';
                        gifDiv.style.cssText = 'margin: 20px 0; max-width: 200px; margin-left: auto; margin-right: auto;';
                        gifDiv.innerHTML = `<img src="${json.data[idx].images.fixed_height.url}" alt="Celebration" style="max-width: 100%; border-radius: 12px;">`;
                        
                        completionDiv.insertBefore(gifDiv, completionDiv.querySelector('.completion-title'));
                        console.log('üéâ Celebration GIF loaded successfully');
                        return;
                    }
                }
            } catch (e) {
                console.error('üéâ Celebration GIF error', e);
            }
        }

        function showFallbackGif() {
            const phase = phases[currentPhase];
            const gifContainer = document.getElementById('gifContainer');
            gifContainer.innerHTML = `<div class="fallback-emoji">${phase.icon}</div>`;
        }

        async function playVoice(text) {
            if (!voiceEnabled) return;
            
            const music = musicPlayer;
            if (music && !music.paused) fadeVolume(music, 0.05);
            
            try {
                const res = await fetch(`https://api.elevenlabs.io/v1/text-to-speech/${ELEVEN_VOICE_ID}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'xi-api-key': ELEVEN_API_KEY },
                    body: JSON.stringify({ text, model_id: 'eleven_multilingual_v2' })
                });
                if (!res.ok) throw new Error(`Voice error ${res.status}`);
                const buf = await res.arrayBuffer();
                const blob = new Blob([buf], { type: 'audio/mpeg' });
                const url = URL.createObjectURL(blob);
                const voice = voicePlayer;
                if (voice) {
                    voice.src = url;
                    voice.volume = 1;
                    voice.onended = () => {
                        URL.revokeObjectURL(url);
                        if (music && !music.paused) fadeVolume(music, 0.2);
                    };
                    await voice.play();
                }
            } catch (e) {
                console.error('Voice error', e);
                if (music && !music.paused) fadeVolume(music, 0.2);
            }
        }

        function toggleVoice() {
            voiceEnabled = !voiceEnabled;
            const btn = document.getElementById('voiceBtn');
            btn.style.opacity = voiceEnabled ? '1' : '0.4';
            btn.className = voiceEnabled ? 'audio-btn enabled' : 'audio-btn';
        }

        function toggleMusic() {
            musicEnabled = !musicEnabled;
            const btn = document.getElementById('musicBtn');
            const player = musicPlayer;
            
            btn.style.opacity = musicEnabled ? '1' : '0.4';
            btn.className = musicEnabled ? 'audio-btn enabled' : 'audio-btn';
            
            if (musicEnabled && player) {
                if (player.paused) player.play().catch(console.error);
            } else if (player) {
                player.pause();
            }
        }

        function initializeMusic() {
            const player = musicPlayer;
            if (player && musicEnabled) {
                const idx = Math.floor(Math.random() * audioFiles.length);
                player.src = audioFiles[idx];
                player.volume = 0.2;
                player.loop = true;
                player.play().catch(() => console.log('Autoplay blocked'));
            }
        }

        function updateDisplay() {
            const phase = phases[currentPhase];
            const container = document.getElementById('timerContainer');
            
            // Update colors and content
            container.className = `timer-container ${phase.color}`;
            document.getElementById('phaseIcon').textContent = phase.icon;
            document.getElementById('phaseTitle').textContent = phase.name;
            document.getElementById('phaseStep').textContent = `Step ${currentPhase + 1} of ${phases.length}`;
            document.getElementById('guidanceTitle').textContent = phase.instructions;
            document.getElementById('guidanceText').textContent = phase.guidance;
            
            updateTimer();
            updateProgress();
            updatePhaseDots();
        }

        function updateTimer() {
            const mins = Math.floor(timeLeft / 60);
            const secs = timeLeft % 60;
            document.getElementById('timerDisplay').textContent = `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function updateProgress() {
            const progress = ((currentPhase + (phases[currentPhase].duration - timeLeft) / phases[currentPhase].duration) / phases.length) * 100;
            document.getElementById('progressFill').style.width = `${progress}%`;
        }

        function updatePhaseDots() {
            const dotsContainer = document.getElementById('phaseDots');
            dotsContainer.innerHTML = '';
            phases.forEach((phase, index) => {
                const dot = document.createElement('button');
                dot.className = 'phase-dot';
                if (index === currentPhase) dot.classList.add('active');
                if (index < currentPhase) dot.classList.add('completed');
                dot.onclick = () => goToPhase(index);
                dot.innerHTML = `
                    <div class="phase-dot-icon">${phase.icon}</div>
                    <div class="phase-dot-number">${index + 1}</div>
                `;
                dotsContainer.appendChild(dot);
            });
        }

        function startTimer() {
            if (timeLeft === 0) timeLeft = phases[currentPhase].duration;
            isRunning = true;
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('pauseBtn').style.display = 'inline-flex';
            
            timer = setInterval(() => {
                timeLeft--;
                updateTimer();
                updateProgress();
                
                if (timeLeft <= 0) {
                    if (currentPhase < phases.length - 1) {
                        nextPhase();
                    } else {
                        completeRitual();
                    }
                }
            }, 1000);
            
            const phase = phases[currentPhase];
            fetchSticker(phase.stickerTags);
            playVoice(phase.guidance);
        }

        function pauseTimer() {
            isRunning = false;
            clearInterval(timer);
            document.getElementById('startBtn').style.display = 'inline-flex';
            document.getElementById('pauseBtn').style.display = 'none';
        }

        function resetTimer() {
            pauseTimer();
            currentPhase = 0;
            timeLeft = phases[0].duration;
            document.getElementById('app').style.display = 'block';
            document.getElementById('completion').style.display = 'none';
            updateDisplay();
            fetchSticker(phases[0].stickerTags);
        }

        function nextPhase() {
            currentPhase++;
            timeLeft = phases[currentPhase].duration;
            updateDisplay();
            const phase = phases[currentPhase];
            fetchSticker(phase.stickerTags);
            playVoice(phase.guidance);
        }

        function goToPhase(index) {
            if (!isRunning) {
                currentPhase = index;
                timeLeft = phases[index].duration;
                updateDisplay();
                fetchSticker(phases[index].stickerTags);
            }
        }

        function completeRitual() {
            pauseTimer();
            document.getElementById('app').style.display = 'none';
            document.getElementById('completion').style.display = 'block';
            
            // Load celebration GIF
            fetchCelebrationGif();
            
            playVoice('Well done, you completed your morning ritual!');
        }

        function resetForTomorrow() {
            resetTimer();
        }

        // Initialize
        window.onload = function() {
            initializeMusic();
            updateDisplay();
            fetchSticker(phases[currentPhase].stickerTags);
            console.log('Beautiful Morning Ritual Timer loaded! üåÖ');
        };
    </script>
</body>
</html>
